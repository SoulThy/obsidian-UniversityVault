# Regole di costruzione del duale (in Programmazione Lineare)

Se il mio problema e' di minimo, il duale sara' di massimo.
- vincolo del primale $\geq 0 \to \lambda\geq 0$ vincolata in segno
- vincolo del primale $=$ ossia attivo $\to \lambda$ non vincolata in segno
- variabile del primale $x_{i}\geq 0\to$ vincolo nel duale relativo risulterà $\leq$
- variabile del primale $x_{j}$ non vincolata in segno $\to$ vincolo relativo nel duale risulterà $=$ ossia (attivo)

## esempio 1
$$
\begin{align}
\text{min } 4x_{1}+2x_{2}-3x_{3}+4x_{4}-x_{5} \\
2x_{1}-3x_{2}-x_{3}+x_{4}-x_{5}\geq 3 \\
-x_{1}-4x_{2}+x_{3}-x_{4}+2x_{5}\leq 1 \\
4x_{1}-x_{2}-x_{3}+2x_{4}-x_{5}=3 \\
x_{1},x_{2},x_{5}\geq 0
\end{align}
$$
Trasformo tutto in $\geq$
$$
\begin{align}
\text{min } 4x_{1}+2x_{2}-3x_{3}+4x_{4}-x_{5} \\
2x_{1}-3x_{2}-x_{3}+x_{4}-x_{5}\geq 3 \\
x_{1}+4x_{2}-x_{3}+x_{4}-2x_{5}\geq-1 \\
4x_{1}-x_{2}-x_{3}+2x_{4}-x_{5}=3 \\
x_{1},x_{2},x_{5}\geq 0
\end{align}
$$
Ho 3 vincoli quindi tre variabili $\lambda$ per il duale e 5 variabili nel primale quindi 5 vincoli nel duale.
$$
\begin{align}
\text{max }3\lambda_{1}-\lambda_{2}+3\lambda_{3} \\
2\lambda_{1}+\lambda_{2}+4\lambda_{3} \leq 4 \\
-3\lambda_{1}+4\lambda_{2}-\lambda_{3} \leq 2 \\
-\lambda_{1}-\lambda_{2}-\lambda_{3}= -3 \\
\lambda_{1}+\lambda_{2}+2\lambda_{3}=4 \\
-\lambda_{1}-2\lambda_{2}-\lambda_{3}\leq -1 \\
\lambda_{1},\lambda_{2}\geq 0
\end{align}
$$
## esempio 2
$$
\begin{align}
\text{min }-6x_{1}-6x_{2}+2x_{3}-5x_{4}+4x_{5}-3x_{6} \\
\lambda_{1}\to5x_{1}-4x_{2}-x_{3}+2x_{4}-x_{5}+x_{6}=3 \\
\lambda_{2}\to6x_{1}-3x_{2}+x_{3}-x_{4}+2x_{5}+2x_{6}\geq -5 \\
x_{1},x_{3},x_{6}\geq 0
\end{align}
$$

il duale risulterà essere
$$
\begin{align}
\text{max } 3\lambda_{1}-5\lambda_{2} \\
5\lambda_{1}+6\lambda_{2}\leq-1 \\
-4\lambda_{1}-3\lambda_{2}= -7\\
-\lambda_{1}+\lambda_{2}\leq 2 \\
2\lambda_{1}-\lambda_{1}=-5 \\
-\lambda_{1}+2\lambda_{2}=4 \\
\lambda_{1}+2\lambda_{2} \leq -3 \\
\lambda_{2}\geq 0
\end{align}
$$
Il $\dots=3$  mi comporta che poi quel lambda non sara' vincolato nel segno, invece per la seconda riga ho $\geq$ e infatti ho quel lambda vincolato in segno ($\lambda_{2}\geq 0$).
I segni dei vincoli nel duale li scrivo guardando quali sono le $x$ vincolate e non in segno.
Esempio risultano vincolate $x_{1},x_{3},x_{6}$ infatti per la riga $1,3,6$ metto $\leq$.
# Risultati teorici sulla dualità nella PL
## Teorema della dualità debole
### enunciato
ci dice che data la coppia problema pl in forma standard (PRIMALE) + il suo duale.
Sia $\bar{x}$ punto ammissibile del primale e $\bar{\lambda}$ punto ammissibile del duale allora risulta $c^T\bar{x}\geq b^T\bar{\lambda}$.
Quindi stiamo dicendo che la funzione obiettivo del primale non sta mai al di sotto della funzione obiettivo del duale.
### dimostrazione
$\bar{\lambda}$ ammissibile per il duale $\implies$ $\bar{\lambda}^TA\leq c^T$.
$\bar{x}$ ammissibile per il primale $\implies$ $A\bar{x}=b$ e anche $\bar{x}\geq 0$
Moltiplichiamo per $\bar{x}$ entrambi i membri, la disuguaglianza resterà essendo $\bar{x}$ non negativo.
$$
\bar{\lambda}^TA\bar{x}\leq c^T\bar{x}\implies c^T\bar{x}\geq b^T\bar{\lambda}
$$

## Corollario della dualità debole
### enunciato
Sia $\bar{x}$ punto ammissibile del problema di minimo.
Sia $\bar{\lambda}$ punto ammissibile del problema di massimo.
Supponiamo che $c^T\bar{x}=b^T\bar{\lambda}$.
Allora risulta che $\bar{x}$ e' soluzione ottima del problema di minimo e $\bar{\lambda}$ e' soluzione ottima del problema di massimo.
### dimostrazione
Vogliamo quindi dimostrare che $\bar{x}$ risulta essere il minimo della funzione obiettivo, ossia per ogni punto ammissibile $x$ risulta $c^Tx\geq c^T\bar{x}$ e per ogni punto ammissibile $\lambda$ del problema duale vale che $b^T\bar{\lambda}\geq b^T\lambda$ ossia $\bar{\lambda}$ e' il massimo.

Preso $x$ ammissibile per il problema primale, dalla dualita segue che
$$
c^Tx\geq b^T\bar{\lambda}=c^T\bar{x}\implies \bar{x}\text{ punto di minimo} 
$$
Preso $\lambda$ ammissibile per il problema duale, dalla dualita segue che
$$
b^T\lambda\leq c^T\bar{x}=b^T\bar{\lambda}\implies\bar{\lambda}\text{ punto di massimo}
$$


## Gap di dualità
Sia $x$ ammissibile per il primale.
Sia $\lambda$ ammissibile per il duale.
Definiamo come **gap di dualita**:
$$
c^Tx-b^T\lambda\geq 0
$$
## Teorema della dualità forte
### enunciato
Ci dice che se uno dei due problemi (primale, duale) ammette soluzione ottima allora anche l'altro problema ammette soluzione ottima e quindi il **gap di dualità** e' nullo.
### richiami
Richiami per la dimostrazione:
Dato un problema in forma standard e supponiamo che abbiamo $\hat{x}$ soluzione ottima del problema allora per il teorema fondamentale della PL esiste una SBA $x^*$ che e' soluzione ottima del problema.
E possiamo anche dire che esiste una SBA che chiamiamo $\bar{x}$ che e' soluzione ottima del problema ed e' tale che $\hat{c}_{N}^T\geq 0^T$ ([[Relazione tra soluzione ottima e vettore costi ridotti]])
### dimostrazione
Senza perdita di generalità prendiamo un problema di PL in forma standard con il suo corrispettivo duale.([[Dualita lineare]]).
Supponiamo per ipotesi che il problema ammette soluzione ottima $\hat{x}$, per i richiami precedenti, esiste una SBA ottima $\bar{x}$ e tale che $\hat{c}_{N}^T=c_{N}^T-c_{B}^TA_{B}^{-1}A_{N}\geq 0$.
Inoltre la sua funzione obiettivo risulta essere $c^T\bar{x}=C_{B}^TA_{B}^{-1}b$.
Prendiamo $\bar{\lambda}^T=c_{B}^TA_{B}^{-1}$.
$$
b^T\bar{\lambda}=c_{B}^TA_{B}^{-1}b=\bar{\lambda}^Tb = c^T\bar{x}
$$
Notiamo che scegliendo $\bar{\lambda}$ in questo modo la funzione obiettivo del duale risulta essere uguale alla soluzione del problema primale.
Dobbiamo adesso vedere se $\bar{\lambda}$ scelto in quel modo e' ammissibile per il duale.
Ossia volgiamo verificare che:
$$
\bar{\lambda}^TA\leq c^T.
$$
Possiamo separare nella parte in base e quella fuori base:
$$
\bar{\lambda}^T\begin{pmatrix}
A_{B} & A_{N}
\end{pmatrix}\leq \begin{pmatrix}
C_{B} & C_{N}
\end{pmatrix}^T.
$$
stiamo quindi chiedendo che 
$$
\begin{align}
\bar{\lambda}^TA_{B}\leq c_{B}^T \\
\bar{\lambda}^TA_{N}\leq c_{N}^T
\end{align}
$$
vediamo la prima
$$
\bar{\lambda}^TA_{B}\leq c_{B}^T 
\implies c_{B}^TA_{B}^{-1}A_{B}\leq c_{B}^T
\implies c_{B}^T\leq c_{B}^T \text{ verificata}
$$
vediamo la seconda
$$
\bar{\lambda}^TA_{N}\leq c_{N}^T
\implies c_{B}^TA_{B}^{-1}A_{N}\leq c_{N}^T \implies c_{N}^T- c_{B}^TA_{B}^{-1}A_{N}\geq 0
$$
Anche questa risulta essere sempre verificata essendo che abbiamo a primo membro il vettore dei costi ridotti che per [[Relazione tra soluzione ottima e vettore costi ridotti]] e' sempre $\geq 0$.

Abbiamo quindi trovato un $\bar{\lambda}$ ammissibile per il duale e tale che $\bar{\lambda}^Tb = c^T\bar{x}$, possiamo quindi concludere che per il corollario della dualità debole che $\bar{\lambda}$ e' soluzione ottima del duale.
## Problema illimitato duale/primale
### enunciato
Se uno dei due problemi e' illimitato, l'altro ha insieme ammissibile vuoto.

> Questo e' abbastanza intuitivo, basta immaginare che il problema illimitato va a "mangiare" quello duale.
### dimostrazione
Supponiamo che il problema di minimo sia illimitato inferiormente, questo significa che 
$$
\text{Esiste la sequenza }\{ x_{k} \} \text{ di punti ammissibili t.c }\lim_{ k \to \infty } c^Tx_{k}=-\infty 
$$
Se supponiamo che il problema di massimo non abbia insieme ammissibile vuoto, questo significa che 
$$
\exists \bar{\lambda} \text{ ammissibile per il problema di massimo}
$$
Adesso ci basta prendere il teorema della dualita debole per ottenere un assurdo:
$$
c^Tx_{k}\geq b^T\bar{\lambda} \quad \forall k
$$
Dove a primo membro abbiamo $-\infty$ e a secondo membro un numero finito. Impossibile, quindi deve risultare vero l'enunciato.
## Specchio riassuntivo dualità
Vediamo una tabella che riassume i risultati possibili di $PL$ per la dualità.

|                | (P) OTTIMO | (P) ILLIMITATO | (P) VUOTO |
| -------------- | ---------- | -------------- | --------- |
| (D) OTTIMO     | SI         | NO             | NO        |
| (D) ILLIMITATO | NO         | NO             | SI        |
| (D) VUOTO      | NO         | SI             | SI        |

> [!example] Esempio di interpretazione
> E' possibile avere un problema primale illimitato e il suo duale corrispettivo contemporaneamente illimitato? Riga 2, Colonna 2, NO.

