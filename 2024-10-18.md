# Modelli multi-periodo
Si tratta di problemi di allocazione ottima di risorse limitate dove
la pianificazione e' effettuata su un orizzonte temporale
composto da piu' periodi elementari.

## Esempio
prendiamo l'esercizio trattato in [[Esercizio PL - MultiPlant]] nel caso in cui abbia solamente il primo impianto di produzione.
Si deve programmare la produzione dei due prodotti $P_{1}$ e $P_{2}$ nelle
due successive settimane sapendo che nella prima settimana si
potranno vendere al piu' 12 prodotti $P_{1}$ e 4 prodotti $P_{2}$, mentre
nella seconda si potranno vendere al piu' 8 prodotti $P_{1}$ e 12
prodotti $P_{2}$.
Inoltre nella prima settimana ==c’e' la possibilità di produrre piu'
prodotti rispetto a quelli che si possono vendere, immagazzinando i
prodotti in eccesso== prevedendo un loro utilizzo nella settimana
successiva.
Costruire un modello lineare che permetta di massimizzare il
profitto complessivo ottenuto dalla vendita dei prodotti nelle due
settimane sapendo che settimanalmente l’industria dispone di 75
Kg di materiale grezzo e che il costo di immagazzinamento di un
prodotto (sia di tipo $P_{1}$ sia di tipo $P_{2}$) e' di 2 euro.

- Materiale grezzo: $75 kg$
- Costo di immagazzinamento: $2euro$
- Settimana 1, al piu' $12 P_{1}$ e al piu' $4P_{2}$
- Settimana 2,al piu' $8P_{1}$ e al piu' $12P_{2}$
- 4kg di materiale grezzo per ogni unita' di $P_{1}$ o $P_{2}$ (vedere [[Esercizio PL - MultiPlant]])
### Procedimento
Per distinguere il prodotto $P_{1}$ prima e seconda settimana e il prodotto $P_{2}$ prima e seconda settimana, ci serviranno 4 variabili.
$$
x_{1},x_{2},x_{3},x_{4}
$$
- $x_{1}$: $P_{1}$ prima settimana
- $x_{2}$: $P_{2}$ prima settimana
- $x_{3}$: $P_{1}$ seconda settimana
- $x_{4}$: $P_{2}$ seconda settimana
Adesso andiamo a rappresentare la quantità in eccesso
$$
y_{1},y_{2}
$$
- $y_{1}$: Quantità di prodotto **extra** $P_{1}$ che non vendo nella prima settimana
- $y_{2}$: Quantità di prodotto **extra** $P_{2}$ che non vendo nella prima settimana
### Funzione obiettivo
$$
\begin{align}
\text{max } 10(x_{1}+x_{3})+15(x_{2}+x_{4})-2(y_{1}+y_{2})
\end{align}
$$
### Vincoli
Vincoli sul materiale grezzo, possiamo utilizzare massimo 75kg di prodotto grezzo per settimana. 
$$
\begin{align}
4x_{1}+4x_{2}\leq 75 \\
4x_{3}+4x_{4}\leq 75 \\
\end{align}
$$
Vincolo per la macchina levigatrice, la macchina può lavorare massimo 80 ore settimanalmente.
$$
\begin{align}
4x_{1}+2x_{2}\leq 80 \\
4x_{3}+2x_{4}\leq 80
\end{align}
$$
Vincolo per la macchina pulitrice, la macchina può lavorare massimo 60 ore settimanalmente.
$$
\begin{align}
2x_{1}+5x_{2} \leq 60 \\
2x_{3}+5x_{4} \leq 60
\end{align}
$$
Vincoli suoi prodotti venduti, ricordiamo che dobbiamo modellare il fatto che possiamo immagazzinare dei prodotti per la seconda settimana.
$$
\begin{align}
x_{1}\leq 12+y_{1} \\
\end{align}
$$
>Quello che stiamo dicendo e' che possiamo produrre nella prima settimana per $x_{1}$ massimo 12unita' $+$ il prodotto extra che venderemo nella seconda settimana

Quello che possiamo vendere nella seconda settimana sara' adesso
$$
\begin{align}
x_{3}+y_{1}\leq 8
\end{align}
$$
Facciamo la stessa cosa per il prodotto $P_{2}$.
$$
\begin{align}
x_{2}\leq 4+y_{2} \\
x_{4}+y_{2}\leq 12
\end{align}
$$

Infine vincoli IMPORTATISSIMI che sono da aggiungere sono i seguenti:
$$
\begin{align}
x_{1}\geq y_{1} \\
x_{2}\geq y_{2}
\end{align}
$$
questo vincoli sono perché per definizione $y_{1},y_{2}$ sono le quantità in eccesso di $x_{1}$ e $x_{2}$. Per esempio non e' possibile produrre nella prima settimana $1$unita' di $P_{1}$ e dire che $y_{1}$ e' per esempio 3, questo non ha senso, se abbiamo prodotto 1 non possiamo avere in eccesso 3. 

### Formulazione finale
$$
\begin{align}
\text{max } 10(x_{1}+x_{3})+15(x_{2}+x_{4})-2(y_{1}+y_{2}) \\
4x_{1}+4x_{2}\leq 75 \\
4x_{3}+4x_{4}\leq 75 \\
4x_{1}+2x_{2}\leq 80 \\
4x_{3}+2x_{4}\leq 80 \\
2x_{1}+5x_{2} \leq 60 \\
2x_{3}+5x_{4} \leq 60 \\
x_{1}-y_{1}\leq 12 \\
x_{3}+y_{1}\leq 8 \\
x_{2}-y_{2}\leq 4 \\
x_{4}+y_{2}\leq 12 \\
-x_{1} + y_{1}\leq 0 \\
-x_{2}+y_{2}\leq 0\\

x_{1},x_{2},x_{3},x_{4},y_{1},y_{2}\geq 0
\end{align}
$$
# Modelli di miscelazione
Nei problemi che vengono formulati come modelli di miscelazione si dispone di un insieme di **materie prime** ("ingredienti") ciascuna caratterizzata da un contenuto noto di determinati "componenti".

Un esempio classico e' quello del problema della dieta https://en.wikipedia.org/wiki/Stigler_diet.
## Formulazione in modo astratto del modello
Supponiamo di avere $n$ sostanze diverse $S_{1},\dots,S_{n}$ ciascuna contenente una certa quantità di $m$ componenti $C_{1},\dots,Cn$.
Supponiamo che ogni sostanza $S_{j}$ abbia costo unitario $p_{j}$, $j=1,\dots,n$.
Sia $a_{ij}$ la quantità di componente $C_{i}$ presente nella sostanza $S_{j}$.
Si vuole ottenere la miscela di $S_{1},\dots,S_{n}$ piu' economica che
soddisfi determinati requisiti qualitativi, ovvero contenga una
quantità non inferiore a $b_{i}$ di ciascun $C_{i}, \quad i=1,\dots,m$.
### Variabili
$x_{1},x_{2},\dots,x_{n}$ rappresentano la quantità di sostanza $S_{j}$ da utilizzare nella miscela, $j=1,\dots,n$.
### Funzione obiettivo
Per minimizzare il costo della miscela
$$
\text{min } p_{1}x_{1}+p_{2}x_{2}+\dots+p_{n}x_{n}=\text{min } p^Tx
$$
### Vincoli
- Vincoli di qualità: la miscela deve contenere una quantità non inferiore a $b_{i}$ di ciascun componente $c_{i}$
$$
a_{i1}x_{1}+a_{i2}x_{2}+\dots+a_{in}x_{n}\geq b_{i}, \quad i=1,\dots,m
$$
- Vincoli di non negatività: $x_{i} \geq 0, \quad i=1,\dots,n$
## Esempio 1
Una dieta prescrive fabbisogni minimi giornalieri di nutrienti:
==carboidrati (150g), proteine (50g) e grassi (70g)==.
Questi sono assunti da cinque alimenti base: pane, latte, uova,
carne, dolci.
I nutrienti contenuti in 100g di ciascun alimento sono i seguenti:

|             | Pane | Latte | Uova | Carne | Dolci |
| ----------- | ---- | ----- | ---- | ----- | ----- |
| Carboidrati | 80   | 4     | 0    | 0     | 80    |
| Proteine    | 0    | 10    | 50   | 60    | 0     |
| Grassi      | 14   | 60    | 35   | 20    | 20    |
|             |      |       |      |       |       |
| Costo(euro) | 0.3  | 0.5   | 1.5  | 3     | 2     |
| Dose Max(g) | 100  | 120   | 50   | 300   | 100   |
Formulare un modello di Programmazione Lineare che permetta di
decidere la dieta di costo minimo.
### Procedimento
Inseriamo le variabili che rappresenteranno la quantità in etti dei vari alimenti che dobbiamo produrre.
$$
x_{1},x_{2},x_{3},x_{4},x_{5}
$$
### Funzione obiettivo
$$
\text{min }0.3x_{1}+0.5x_{2}+1.5x_{3}+3x_{4}+2x_{5}
$$
### Vincoli
Vincoli per il rapporto dei carboidrati
$$
80x_{1}+4x_{2}+80x_{5} \geq 150
$$
Vincoli per il rapporto delle proteine
$$
10x_{2}+50x_{3}+60x_{4}\geq 50
$$
Vincoli per il rapporto dei grassi
$$
14x_{1}+60x_{2}+35x_{3}+20x_{4}+20x_{5}\geq 70
$$
Vincoli sulla dose massima, che nella tabella viene riportata in grammi quindi dobbiamo convertirla $100g \to 1hg$.
$$
\begin{align}
x_{1}\leq 100 /100 \\
x_{2}\leq 120 /100 \\
x_{3}\leq 50 /100\\
x_{4}\leq 300 /100\\
x_{5}\leq 100 /100
\end{align}
$$
Vincoli di non negatività
$$
\begin{align}
x_{1},x_{2},x_{3},x_{4},x_{5}\geq 0
\end{align}
$$
## Esempio 2
ACC-ricrea e' un’azienda che produce acciaio 18/10.
L’azienda ha analizzato le caratteristiche di sei lotti di rottami di
ferro, riportate nella seguente tabella, dove sono riportati anche il
peso di ciascun lotto e il costo in euro per quintale di rottame:

|                | L1  | L2  | L3  | L4  | L5  | L6  |
| -------------- | --- | --- | --- | --- | --- | --- |
| Ferro(%)       | 93  | 76  | 74  | 65  | 76  | 68  |
| Nichel(%)      | 5   | 13  | 11  | 16  | 6   | 23  |
| Cromo(%)       | 0   | 11  | 12  | 14  | 20  | 8   |
| Impurita(%)    | 2   | 0   | 3   | 5   | 2   | 1   |
|                |     |     |     |     |     |     |
| Peso(quintali) | 30  | 90  | 50  | 70  | 60  | 50  |
| Costo          | 50  | 100 | 80  | 85  | 92  | 115 |
L’obiettivo per ACC-ricrea e' produrre, al costo minimo, ==almeno
100 quintali di acciaio== 18/10 ==con una presenza del 18% di cromo e
10% di nichel, almeno il 65% di ferro e al piu un 1% di impurità==.
### Variabili
$$
x_{1},x_{2},x_{3},x_{4},x_{5},x_{6}
$$
### Funzione obiettivo
$$
\text{min } 50x_{1}+100x_{2}+80x_{3}+85x_{4}+92x_{5}+115x_{6}
$$
### Vincoli
Vincoli sulla produzione minima di acciaio
$$
\sum_{j=1}^{6} x_{j} \geq 100
$$
Vincoli per ottenere una presenza del $18\%$ di cromo
$$
11\%x_{2}+12\%x_{3}+14\%x_{4}+20\%x_{5}+8\%x_{6}=18\%\left( \sum_{j=1}^{6} x_{j} \right)
$$
$$
11x_{2}+12x_{3}+14x_{4}+20x_{5}+8x_{6}=18\left( \sum_{j=1}^{6} x_{j} \right)
$$

>Quello che stiamo chiedendo e' che ci deve essere il $18\%$ di cromo nel totale dell'acciaio prodotto dai lotti.

Vincoli per ottenere una presenza del $10\%$ di nichel
$$
5x_{1}+13x_{2}+11x_{3}+16x_{4}+6x_{5}+23x_{6} = 10\left( \sum_{i=1}^{6}x_{j} \right)
$$
Vincoli per ottenere una presenza del 65% di ferro
$$
93x_{1}+76x_{2}+74x_{3}+65x_{4}+76x_{5}+68x_{6}\geq 65\left( \sum_{j=1}^{6} x_{j} \right)
$$

Vincoli ottenere al piu' l'1 di impurità
$$
2x_{1}+3x_{3}+5x_{4}+2x_{5}+1x_{6}\leq 1\cdot\left( \sum_{i=1}^{6} x_{j} \right)
$$
Vincoli di produzione massima in quintali per ciascun lotto
$$
\begin{align}
x_{1}\leq 30 \\
x_{2} \leq 90 \\
x_{3} \leq 50 \\
x_{4} \leq 70 \\
x_{5} \leq 60 \\
x_{6} \leq 50
\end{align}
$$
Vincoli di non negatività
$$
\begin{align}
x_{j} \geq 0 \quad j=1,\dots,6
\end{align}
$$