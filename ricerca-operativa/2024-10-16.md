#ricerca-operativa 
- **Metodo del simplesso**
	- [[Problema di PL in forma standard]]
	- [[Soluzione di base ammissibile]]
- **Dualità**

# Problema di PL in forma standard
Fa riferimento a [[Caratterizzazione di un problema di PL]] solo che vogliamo tutti i vincoli composti da sole uguaglianze e deve essere un problema di "$min$".
$$
\begin{array}{cccc}a_{11}x_1+&\dots&+a_{1n}x_n&= b_1\\a_{21}x_1+&\dots&+a_{2n}x_n&= b_2\\\vdots&\dots&\vdots&\vdots\\a_{m1}x_1+&\dots&+a_{mn}x_n&= b_m.\end{array}
$$
$$
\left\{\begin{array}{l}
\min c^Tx\\
Ax= b \\
x\geq 0
\end{array}\right.
$$

Come facciamo partendo da un problema di PL non in forma standard ad passare all'equivalente in forma standard?
Se il problema richiede la massimizzazione, ricorda:
$$\text{max } c^Tx \iff \text{min }(-c^Tx)$$
Adesso per i vincoli
$a_{i}^Tx \leq b_{i} \implies b_{i}-a_{i}^Tx \geq 0$
$s_{i}=b_{i}-a_{i}^Tx \implies a_{i}^Tx+s_{i}=b_{i}$ con $s_{i}\geq 0$

per un vincolo con $\geq$:
$a_{j}^Tx \geq b_{j} \implies a_{j}^Tx-s_{j}=b_{j}$ con $s_{j} \geq 0$

e se $x_{h}$ non e' vincolata in segno (per progettazione)?
$$
\begin{align}
x_{h} = x_{h}^+ - x_{h}^- \\
x_{h}^+,x_{h}^- \geq 0
\end{align}
$$

## esempio di "standardizzazione"

$$
\begin{align}
\text{max } -4x_{1}+2x_{2}-3x_{3}+x_{4}-x_{5} \\
2x_{1}-x_{2}-x_{5}+2x_{4}-x_{5}\geq 2 \\
-x_{1}+2x_{2}-x_{3}-x_{4}+2x_{5} \leq -3 \\
-x_{1}+2x_{2}-x_{3}+2x_{4}-x_{5} = 1 \\
x_{1},x_{3},x_{5}\geq 0
\end{align}
$$
procediamo a renderlo un problema di minimizzazione
$$
\text{max } c^Tx \iff \text{min }(-c^Tx)
$$
$$
\text{min } +4x_{1}-2x_{2}+3x_{3}-x_{4}+x_{4}
$$
adesso per rendere tutti i vincoli uguaglianze
$$
\begin{align}
2x_{1}-x_{2}-x_{5}+2x_{4}-x_{5}-s_{1}= 2 \\
-x_{1}+2x_{2}-x_{3}-x_{4}+2x_{5}+s_{2} = -3 \\
-x_{1}+2x_{2}-x_{3}+2x_{4}-x_{5} = 1 \\ 
x_{1},x_{3},x_{5},s_{1},s_{2}\geq 0
\end{align}
$$
Dove nelle equazioni che erano da "correggere" abbiamo introdotto un termine $s_{j}$ 
Per le $x$ non vincolate in segno invece
$$
\begin{align}
x_{2}=x_{2}^+ - x_{2}^- \\
x_{4}=x_{4}^+ - x_{4}^- \\
x_{2}^+, x_{2}^-,x_{4}^+, x_{4}^- \geq 0
\end{align}
$$
Notiamo che siamo partiti da $5$ variabili e dopo aver ottenuto il problema in forma standard abbiamo $9$ variabili (questo e' il prezzo che paghiamo).

Post-standardizzazione le matrici risultano essere:
$$
C=\begin{pmatrix}
4 \\
-2 \\
2 \\
3 \\
-1 \\
1 \\
1 \\
0 \\
0 \\

\end{pmatrix};
A=\begin{pmatrix}
2 & -1 & 1 & -1 & 2 & -2 & -1 & -1 & 0 \\
-1 & 2 & -2 & -1 & -1 & -1 & 2 & 0 & 1 \\
-1 & 2 & -2 & -1 & 2 & 2 & -1 & 0 & 0
\end{pmatrix};
b = \begin{pmatrix}
2 \\
-3 \\
1
\end{pmatrix}
$$
## Grandezze delle matrici e esistenza soluzione
$$
\begin{array}
 & x \in \mathbb{R} & A(m\times n) & b \in \mathbb{R}^m & c \in \mathbb{R}^n
\end{array}
$$
Con $Ax=b$ abbiamo quindi un sistema da risolvere.
Ricordiamo che per Rouche Capelli il sistema ammette soluzione se e solo se 
$$
rango(A)=rango(A|B)
$$
La soluzione e' unica se e solo se 
$$
rango(A)=n
$$
## Matrice di base e fuori base

$$
\left\{\begin{array}{l}
\min c^Tx\\
Ax= b \\
x\geq 0
\end{array}\right.
$$
$$
A=\begin{pmatrix}
A_{B} & A_{N}
\end{pmatrix}
$$
$A_{B}(m\times m)$ NON SIGOLARE ($\det \neq 0$) $\implies$ MATRICE DI BASE
$A_{N}(m\times n-m) \implies$ MATRICE FUORI BASE



<span style="color:rgb(255, 0, 0)">?? se esiste soluzione non e' detto che l'insieme ammissibile sia NON vuoto</span>
Il prof ha detto:
che $x$ e' soluzione se verifica i vincoli del problema di programmazione lineare
mentre $x$ può comunque non essere all'interno del sistema ammissibile seppure verifica i vincoli, infatti se non verifica $x\geq 0$ allora non compare dentro l'insieme ammissibile


Esempio:
$$
\begin{align}
\text{min } 2x_{1}-3x_{2}+x_{3}-x_{4} \\
x_{1}+2x_{2}-x_{3}+x_{4}=3 \\
-x_{1}+x_{2}+2x_{3}-x_{4}=1 \\
x\geq 0
\end{align}
$$
Abbiamo $m = 2$ e $n = 4$.
$$
A=\begin{pmatrix}
1 & 2 & -1 & 1 \\
-1 & 1 & 2 & -1
\end{pmatrix};
A_B=\begin{pmatrix}
1 & 2 \\
-1 & 1
\end{pmatrix}
$$
Dove abbiamo scelto una sotto-matrice $m\times m$ non singolare, adesso verifichiamo se ha determinante non nullo.
$$
\det(A_{B}) \neq 0 \implies \text{MATRICE DI BASE}
$$
La restate matrice sara' la fuori base
$$
A_{N}=\begin{pmatrix}
-1 & 1 \\
2 & -1
\end{pmatrix}
$$
Potevamo scegliere una sotto-matrice differente $A_{B}$.

Il numero **massimo** di matrici di base e' $\begin{pmatrix}n \\m\end{pmatrix}$.

Genericamente $B=\{ i_{1},i_{2},\dots,i_{m} \}$ e' l'insieme di indici corrispondenti alle colonne della matrice di base, Nel nostro esempio abbiamo scelto $B=\{ 1,2 \}$
Facciamo la stessa cosa per gli indici delle colonne della matrice fuori base, nel nostro esempio $N=\{ 3,4 \}$.

## Soluzione di base (SB)
$$
x=\begin{pmatrix}
x_{B} \\
x_{B}
\end{pmatrix};
c^T=\begin{pmatrix}
c_{B}^T & C_{N}^T
\end{pmatrix}
$$
Possiamo adesso scrivere il problema come
$$
\begin{align}
\text{min } c_{B}^Tx_{B}+c_{N}^Tx_{N} \\
A_{B}x_{B}+A_{N}x_{N}=b \\
x_{B}\geq 0 \\
x_{N}\geq 0
\end{align}
$$
Si definisce soluzione di base
 $\bar{x}_{N}=0$ e $\bar{x}_{B}=A_{B}^{-1}b$
abbiamo
$$
\bar{x}=\begin{pmatrix}
A_{B}^{-1}b \\
0
\end{pmatrix}
$$
Esempio
$$
\begin{align}
\text{min } 4x_{1}-2x_{2}+x_{3}-x_{4}\\
x_{1}+2x_{2}-x_{3}-x_{4}=2 \\
-x_{1}-x_{2}+2x_{3}+x_{4}=1 \\
x\geq 0
\end{align}
$$

Troviamo la soluzione di base data una matrice di base

$$
B=\{ 1,3 \}; N=\{ 2,4 \}
$$
$$
A_{B}=\begin{pmatrix}
1 & -1 \\
-1 & 2
\end{pmatrix}
$$
$$
\det A_{B}\neq 0 \implies \text{e' una matrice di base}
$$
$$
A_{B}^{-1}=\begin{pmatrix}
2 & 1 \\
1 & 1
\end{pmatrix}
$$
$$
\bar{x}_{B}=A_{B}^{-1}b=\begin{pmatrix}
5 \\
3
\end{pmatrix}
$$
$$
\bar{x}=\begin{pmatrix}
A_{B}^{-1}b \\
0
\end{pmatrix}=\begin{pmatrix}
5 \\
0 \\
3 \\
0
\end{pmatrix}
$$
Dove notiamo che abbiamo messo la riga 2 e 4 a $0$, perché sono quelle che corrispondono alla matrice di fuori base.

### Soluzione di base ammissibile e non
Se tutte le componenti di $\bar{x}$ risultano ammissibili (in genere non negative) allora la chiameremo **soluzione di base ammissibile**
Piu in specifico se 
$$A_{B}^{-1}b\geq 0 \implies \bar{x} \text{ e' detta soluzione di base ammissibile (SBA)}$$

## Corrispondenza biunivoca tra vertici e SBA
Dato un problema PL in forma standard, un punto ammissibile del problema e' un vertice se e solo se e' una Soluzione di base ammissibile.

## Teorema fondamentale della PL riferito alle SBA
A questo punto se prendiamo il [[Teorema fondamentale della programmazione lineare]] e sostituiamo ad ogni "vertice" la parola "soluzione di base ammissibile" otteniamo l'equivalente teorema riferito alle SBA.