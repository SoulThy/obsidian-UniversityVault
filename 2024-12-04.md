Oggi vedremo 
1. Condizioni di ottimalita nella pl
2. teoremi degli scarti complementari
# Condizioni di ottimalita nella PL
## Enunciato
Prendiamo il [[Caratterizzazione di un problema di PL in forma standard|problema di PL in forma standard]] con il suo [[Dualita lineare|duale]], il teorema ci dice che 
$\bar{x}$ e $\bar{\lambda}$ sono rispettivamente soluzioni ottime del problema primale e del problema duale se e solo se:
$$
\begin{align}
\text{1)}&A\bar{x}=b,\bar{x}\geq 0 \text{ ammissibilita primale}\\
\text{2)}&\bar{\lambda}^TA\leq c^T \text{ ammissibilita duale}\\
\text{3)}&c^T\bar{x}=b^T\bar{\lambda} \text{ assenza di gap di dualita}
\end{align}
$$
## Dimostrazione condizione sufficiente
> Vogliamo dimostrare che se vale 1), 2), 3) $\implies$ vale il teorema, ossia $\bar{x}$ e $\bar{\lambda}$ sono soluzioni ottime del problema primale e duale.

Possiamo utilizzare il [[Corollario della dualità debole]] e quindi la condizione sufficiente sara' subito dimostrata.
## Dimostrazione condizione necessaria
> Vogliamo dimostrare che $\bar{x}$ e $\bar{\lambda}$ soluzioni ottime $\implies$ valgono la 1), 2), 3).

Per ipotesi le nostre soluzioni sono ottime e quindi necessariamente ammissibili.
- $\bar{x}$ ammissibile $\implies$ vale la 1) 
- $\bar{\lambda}$ ammissibile $\implies$ vale la 2)
- Dal [[Teorema della dualita forte]] $\implies$ vale la 3)
# Esercizio dualita - fo tramite duale 
Si consideri il problema di [[Caratterizzazione di un problema di PL|PL]]
$$
\begin{align}
\text{min } 5x_{1}-2x_{2}+3x_{3}-7x_{4} \\
2x_{1}-2x_{2}+3x_{3}+a_{4}x_{4}\geq 4 \\
x_{1},x_{2},x_{3},x_{4}\geq 0 \\
\end{align}
$$
Utilizzando la teoria della dualità
- Determinare per quali valori d $a_{4}$ il problema ammette soluzione ottime
- Determinare il valore della funzione obiettivo all'ottimo
Otteniamo il suo duale tramite [[Regole di costruzione di un problema duale]]:
$$
\begin{align}
\text{max } 4\lambda \\
2\lambda\leq 5 \\
-2\lambda \leq 2 \\
3\lambda \leq 3 \\
a_{4}\lambda\leq -7 \\
\lambda \geq 0
\end{align}
$$
Dalla seconda e terza equazione otteniamo che 
$$
\lambda =1
$$
adesso dalla quarta:
$$
a_{4}\cdot\lambda\leq -7 \implies a_{4}\leq -7
$$
La funzione obiettivo:
$$
\text{max } 4\lambda \implies 4\cdot 1 = 4
$$
# Prezzo ombra
Il **Prezzo Ombra**  e' il prezzo massimo che siamo disposti a pagare per ottenere un' unita di prodotto in piu

> [!example]
>  Se ho 100 ore e ne consumo 80, quanto sono disposto a pagare per avere 101 ore?
>   0, tanto sempre 80 ne uso. Quindi il mio prezzo ombra sarebbe 0.
# Teorema degli scarti complementari
## Teorema degli scarti complementari caso standard
### Enunciato
Prendiamo il [[Caratterizzazione di un problema di PL in forma standard|problema di PL in forma standard]] con il suo [[Dualita lineare|duale]].
Il teorema ci dice che $\bar{x}$ e $\bar{\lambda}$ sono soluzioni ottime dei rispettivi problemi se e solo se
$$
\begin{align}
\text{1)}&A\bar{x}=b,\bar{x}\geq 0 \\
\text{2)}&\bar{\lambda}^TA\leq c^T \\
\text{3)}&\bar{x}_{i}(\bar{\lambda}^TA_{i}-c_{i})=0 \quad i=1,\dots,n
\end{align}
$$
La condizione $(3)$ viene chiamata **condizione di complementarità**.
Queste condizioni risultano essere quasi identiche a quelle del [[Condizioni di ottimalita]], infatti la terza condizione garantisce indirettamente la l'assenza di gap di dualità.

> Le condizioni di complementarità implicano che nessuna risorsa è sprecata o utilizzata in modo inefficiente.
### Dimostrazione
Per le [[Condizioni di ottimalita]] sappiamo che $\bar{x}$ e $\bar{\lambda}$ sono soluzioni ottime se e solo se valgono $1),2)+c^T\bar{x}=b^T\bar{\lambda}$.
???????????? come otteniamo questa dopo
???????????? come otteniamo questa dopo
???????????? come otteniamo questa dopo
$$
\lambda^TA+y^T=c^T\implies\lambda^TAx+y^Tx=c^Tx \implies \bar{\lambda}^TA\bar{x}+\bar{y}^T\bar{x}=c^T\bar{x}
$$
Da quest ultima abbiamo che
$$
\implies\bar{\lambda}^Tb+\bar{y}^T\bar{x}=c^T\bar{x}
$$
dove essendo che $c^T\bar{x}=b^T\bar{\lambda}$, resta
$$
\bar{y}^T\bar{x}=0
$$
Che possiamo riscrivere come 
$$
\sum_{i=1}^{n} \bar{y}_{i}\bar{x}_{i} = 0
$$
E dato che $y_{i},x_{i}\geq 0$ vale:
$$
\bar{y}_{i}\bar{x}_{i} = 0
$$
Dalla prima equazione:
$$
\bar{\lambda}^TA\bar{x}+\bar{y}^T\bar{x}=c^T\bar{x}\implies \bar{y}_{i} = c_{i}-\bar{\lambda}^TA_{i}
$$
per cui
$$
\bar{x}_{i}(\bar{\lambda}^TA_{i}-c_{i})=0
$$
## esempio
Calcolare le condizioni di complementarita
$$
\begin{align}
\text{min }3x_{1}+2x_{2}-3x_{3}+x_{4}-x_{5} \\
4x_{1}-2x_{2}+3x_{3}-x_{4}+2x_{5}=3 \\
-x_{1}-x_{2}+x_{3}+2x_{4}-x_{5}=4 \\
x_{1},x_{2},x_{3},x_{4},x_{5} \geq 0
\end{align}
$$
Costruiamo il suo duale
$$
\begin{align}
\text{max }3\lambda_{1}+4\lambda_{2} \\
4\lambda_{1}-\lambda_{2}\leq 3 \\
-2\lambda_{1}-\lambda_{2}\leq 2 \\
3\lambda_{1}+\lambda_{2}\leq -3 \\
-\lambda_{1}+2\lambda_{2} \leq 1 \\
2\lambda_{1} - \lambda_{2} \leq -1
\end{align}
$$
Le condizioni di complementarita sono:
$$
\begin{align}
x_{1}(4\lambda_{1}-\lambda_{2}-3) = 0 \\
x_{2}(-2\lambda_{1}-\lambda_{2}-2) = 0 \\
x_{3}(3\lambda_{1}+\lambda_{2}-3) = 0 \\
x_{4}(-\lambda_{1}-2\lambda_{2}-1) = 0 \\
x_{5}(2\lambda_{1}-\lambda_{2} +1) = 0
\end{align}
$$

## teorema degli scarti complementari caso non standard
Dato il problema primale in forma non standard con il suo corrispettivo duale.
$\bar{x}$ e $\bar{\lambda}$ sono soluzioni ottime dei rispettivi problemi se e solo se
$$
\begin{align}
\text{1)}&A\bar{x}=b,\bar{x}\geq 0 \\
\text{2)}&\bar{\lambda}^TA\leq c^T \\
\text{3)}&\bar{x}_{i}(\bar{\lambda}^TA_{i}-c_{i})=0 \quad i=1,\dots,n \\
\text{3bis)}&\bar{\lambda}_{i}(a_{i}^T\bar{x}-b_{i})=0 \quad i=1,\dots,m
\end{align}
$$
### dimostrazione
$$
Ax-z=b \implies\lambda^TAx-\lambda^Tz=\lambda^Tb
$$
con $z\geq 0$ e:
$$
\lambda^TA+y^T=c^T \implies\lambda^TAx+y^Tx=c^Tx \implies y^Tx+\lambda^Tz=c^Tx-\lambda^Tb
$$
con $y\geq 0$
Essendo che $\bar{x}$ e $\bar{\lambda}$ sono soluzioni ottime se e solo se $c^T\bar{x}=b^T\lambda$ allora
$$
\bar{y}^T\bar{x}+\bar{\lambda}^T\bar{z}=0 \iff \bar{y}_{i}\bar{x}_{i}=0;\bar{\lambda}_{i}\bar{z}_{i}=0 \quad i=1,\dots,n;i=1,\dots,m
$$
infine
$$
\begin{align}
\bar{\lambda}_{i}(a_{i}^T\bar{x}-b_{i})=0 \\
\bar{x}_{i}(\bar{\lambda}^TA_{i}-c_{i})=0
\end{align}
$$

# esercizio sulla dualita (condizioni di complementarita)
Utilizzando la teoria della dualita dimostrare che il punto $x^*=\begin{pmatrix}0&0&1&6\end{pmatrix}^T$ e' soluzione ottima del problema:
$$
\begin{align}
\text{min }3x_{1}-4x_{2}+2x_{3}-x_{4} \\
2x_{1}+12x_{2}+x_{4}=6 \\
x_{1}+3x_{2}+x_{3}=1 \\
x\geq 0
\end{align}
$$
Costruiamo il duale:
$$
\begin{align}
\text{max }6\lambda_{1}+1\lambda_{2} \\
2\lambda_{1}+\lambda_{2}\leq 3 \\
12\lambda_{1}+3\lambda_{2}\leq -4 \\
\lambda_{2}\leq 2 \\
\lambda_{1}\leq -1 \\
\end{align}
$$
Utilizzando  le condizioni di complementarita:
$$
\begin{align}
x_{1}^*(\dots ) = 0 \implies 0\cdot(\dots)= 0 \\
x_{2}^*(\dots ) = 0 \implies 0\cdot(\dots)= 0 \\
x_{3}^*(\lambda_{2}^*-2) = 0 \implies \lambda_{2}^* =2 \\
x_{4}^*(\lambda_{1}^*+1) = 0 \implies \lambda_{1}^*=-1
\end{align}
$$
Se questi valori di $\lambda^*$ verificano le condizioni del problema duale, ossia sono ammissibili sicuramente il punto $x^*$ e' soluzione ottima del problema.
# esercizio di dualita 
$$
\begin{align}
\text{min }2x_{1}+3x_{2} \\
x_{1}+a_{2}x_{2}\geq 1 \\
x_{2}\geq 0
\end{align}
$$
- Definire i valori di $a_{2}$ affinche il problema ammetta soluzione ottima.
- Determinare il valore della funzione obiettivo all'ottimo
Scriviamo il duale
$$
\begin{align}
\text{max }\lambda \\
\lambda=2 \\
|a_{2}|\lambda\leq 3 \\
\lambda\geq 0
\end{align}
$$
Quindi
$$
|a_{2}|\lambda\leq 3 \implies|a_{2}|\cdot 2\leq 3 \implies |a_{2}| \leq \frac{3}{2}
$$
ossia:
$$
-\frac{3}{2}\leq a_{2}\leq \frac{3}{2}
$$
Affinche il problema ammetta soluzione ottima.
Il valore ottimo essendo la funzione obiettivo:
$$
\text{max } \lambda \implies 2
$$