# Teoria della dualità
Si divide in 
- caso della programmazione lineare (noi studieremo questo)
- caso della programmazione non lineare
## caso programmazione lineare
Per ogni problema primale, si può costruire un problema duale, che sarà un problema di minimizzazione (se il primale è di massimizzazione) oppure di massimizzazione (se il primale è di minimizzazione). 

### Concetto di Rilassamento di un Problema

Quando parliamo di **rilassamento di un problema** in ottimizzazione, ci riferiamo a una tecnica per semplificare un problema complesso, rendendolo più facile da risolvere. 

#### Definizione Formale

Dato un problema di ottimizzazione (I) nella forma:
$$
\min f(x) \quad \text{soggetto a} \quad x \in A
$$
definiamo un secondo problema (II) nella forma:
$$
\min g(x) \quad \text{soggetto a} \quad x \in B
$$
e diciamo che (II) è un **rilassamento di (I)** se:

1. **Insieme di fattibilità esteso**: $A \subseteq B$, cioè l’insieme di vincoli di (II) include o "rilassa" quelli di (I). Questo significa che ogni soluzione ammissibile di (I) è anche ammissibile per (II), ma non necessariamente viceversa.
   
2. **Funzione obiettivo rilassata**: Per ogni $x \in A$, si ha $g(x) \leq f(x)$. Questo implica che la funzione obiettivo del rilassamento (II) sottostima o uguaglia quella del problema originale per tutte le soluzioni ammissibili del problema originario.

In pratica, risolvere il rilassamento significa ottenere una stima del valore ottimale di $f(x)$, e questa soluzione può fornire una "frontiera" o limite inferiore (nel caso di minimizzazione) che ci dice quanto in basso potremmo spingere la funzione obiettivo di (I).

Un esempio comune è il **rilassamento continuo**: se il problema (I) è un problema di ottimizzazione su variabili intere, possiamo creare un rilassamento continuo permettendo alle variabili di assumere valori reali (cioè, togliamo i vincoli di integrità).

### Rilassamento Lagrangiano

Il **rilassamento lagrangiano** è una tecnica di rilassamento che utilizza i moltiplicatori di Lagrange per "rilassare" alcuni dei vincoli del problema. In questo caso, certi vincoli difficili vengono incorporati direttamente nella funzione obiettivo, associando a ciascuno di essi un moltiplicatore lagrangiano. Questo trasforma il problema originale in uno più facile da risolvere, pur mantenendo informazioni preziose sui vincoli rilassati.

#### Costruzione del Rilassamento Lagrangiano

Supponiamo di avere un problema (I) nella forma:
$$
\min f(x) \quad \text{soggetto a} \quad h_i(x) \leq 0, \, \forall i=1,\dots,m, \quad x \in X
$$
dove $h_i(x) \leq 0$ rappresenta un insieme di vincoli difficili da gestire.

Nel rilassamento lagrangiano, questi vincoli vengono incorporati nella funzione obiettivo con i **moltiplicatori lagrangiani** $ \lambda_i \geq 0 $ per ogni vincolo $h_i(x)$. La funzione obiettivo del rilassamento lagrangiano diventa quindi:
$$
L(x, \lambda) = f(x) + \sum_{i=1}^m \lambda_i h_i(x)
$$
Il problema rilassato diventa:
$$
\min_{x \in X} L(x, \lambda)
$$
dove $\lambda$ è un vettore di moltiplicatori che viene scelto per ottenere il miglior limite possibile per il problema originale.

#### Interpretazione e Utilizzo

1. **Limite Inferiore**: Per ogni scelta dei moltiplicatori $\lambda \geq 0$, la soluzione del rilassamento lagrangiano fornisce un limite inferiore al problema originale (nel caso di minimizzazione). Variando $\lambda$, possiamo migliorare questo limite e avvicinarci al valore ottimale di $f(x)$.

2. **Ottimizzazione Duale**: Si può pensare a risolvere il problema lagrangiano come trovare il valore migliore dei moltiplicatori $\lambda$ per ottenere il limite inferiore più alto possibile (massimizzare il limite inferiore), ottenendo così il **problema duale**.

In sintesi, il rilassamento lagrangiano consente di semplificare un problema mantenendo informazioni utili sui vincoli rilassati tramite i moltiplicatori di Lagrange, e aiuta a ottenere buone approssimazioni al problema originale.


### Rilassamento Lagrangiano per problema di PL in forma standard
Dato un problema di PL in forma standard, facendo riferimento al rilassamento lagrangiano:
$$
\begin{align}
h(x) &  \to Ax=b \\
s  & \to x\geq 0
\end{align}
$$
Fissato $\lambda \in \mathbb{R}^m$
$$
L(\lambda)=\text{min }c^T x-\lambda (Ax-b)=\text{min }\lambda^Tb+c^Tx-\lambda^TAx=\lambda^Tb+min(c^T-\lambda^TA)x
$$
Quindi il duale:
$$
\text{max }L(\lambda)
$$
$1^o$ caso: 
$$
c^T-\lambda^TA\geq 0 \implies x^*=0\implies L(\lambda)=\lambda^Tb=b^T\lambda
$$
Quindi
$$
\implies \begin{align}
\text{max } b^T\lambda \\
\lambda^TA\leq c^T
\end{align}
$$
$2^o$ caso:
Esiste $i$ t.c.
$$
c_{i}-\lambda^TA_{i} < 0 \implies L(\lambda) = - \infty
$$
### Esempio di costruzione del duale
$$
\begin{align}
\text{min } 5x_{1}-3x_{2}+3x_{3}-4x_{4}+5x_{5}-6x_{6} \\
\lambda_{1}\to 2x_{1}-3x_{2}-x_{3}+x_{4}-5x_{5}+x_{6}=3 \\
\lambda_{2}\to -x_{1}+x_{2}+2x_{3}+2x_{4}-3x_{5}-x_{6}=1 \\
x\geq 0
\end{align}
$$
Costruiamo il duale:
$$
\begin{align}
\text{max } 3\lambda_{1}+\lambda_{2} \\
2\lambda_{1}-\lambda_{2}\leq 5 \\
-3\lambda_{1}+\lambda_{2}\leq-3 \\
-\lambda_{1}+\lambda_{2}\leq 3 \\
\lambda_{1}+2\lambda_{2}\leq -4 \\
-5\lambda_{1}-3\lambda_{2}\leq 5 \\
\lambda_{1}-\lambda_{2}\leq-6
\end{align}
$$
notiamo che si scambiano i numeri dei vincoli con il numero di variabili.